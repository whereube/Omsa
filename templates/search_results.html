{% extends "base.html" %} {% block title %}Start{% endblock %} {% block content
    %}
<h1>Sökresultat</h1>
<form action="/article_search" method="POST">
  <div class="mb-3">
    <label for="free_text" class="form-label">Skriv sökord</label>
    <input type="text" class="form-control search_by_title" id="free_text" name="free_text" aria-describedby="free_text_search">
    <div id="free_text_search" class="form-text">Sök på vad du vill</div>
  </div>
  <div class="mb-3">
    <label for="main_category" class="form-label">Huvudkategori</label>
    <select id="search_category_id" name="main_category" class="form-control">
      <option value=None selected="true" disabled>Välj kategori</option>
      <option value="">Ingen</option>
      {%for category in main_categories%}
        <option value={{category[0]}}>{{category[1]}}</option>
      {%endfor%}
    </select>
    <div id="show_sub_categories"></div>
  </div>
  <input type="submit" class="btn btn-primary search_button" value="Sök">
</form>

{%if articles != None%}
  <div class="conatiner-articles">
    <div class="row justify-content-md-center">
      {%for row in articles%}
        <div class="card mb-3" data-bs-toggle="collapse" data-bs-target="#collapseWidthExample{{row[0]}}" aria-expanded="false" aria-controls="collapseWidthExample">
          <div class="row g-0">
            {%for image in images%}
                {%if row[0] == image[1]%}
                <div class="col-md-4 pictures">
                  <img src="/static/article_images/{{image[2]}}" id="temp_pic" class="img-fluid rounded-start" alt="Artikelbild">
                </div>
                {%endif%}
            {%endfor%}
            <div class="col-md-8">
              <div class="card-body">
                <h4 class="card-title">{{row[2]}}</h4>
                <p>Stad: {{row[23]}}</p>
                <p>Prisnivå: {{row[26]}}</p>
                <p>Kategori: {{row[31]}}</p>
                <p class="card-text"><small class="text-muted">Skapad: {{row[6].strftime('%Y-%m-%d')}}</small></p>
                <div class="collapse" id="collapseWidthExample{{row[0]}}">
                  <p>{{row[3]}}</p>
                  <form action="/wife_article_id" method="POST">
                    <input type="hidden" id="wife_article_id" name="wife_article_id" value={{row[0]}}>
                    <button  class="btn btn-primary" type="submit">Visa intresse</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
    {%endfor%}
    </div>
  </div>
{%else%}
  <p>Inga resultat</p>
{%endif%}

<script type="text/javascript">
$(document).ready(function() {
 $('#search_category_id').change(function(){
    $.post("/get_child_categories", {
     parent_id: $('#search_category_id').val(),
    }, function(response){ 
        $('#show_sub_categories').html(response);
        $('#show_sub_categories').append(response.htmlresponse);
    });
    return false;
  });
}); 
</script>

{% endblock %}