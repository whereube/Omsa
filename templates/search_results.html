{% extends "base.html" %} {% block title %}Start{% endblock %} {% block content
    %}
<h1>Sökresultat</h1>

<form action="/article_search" method="POST">
  <div class="mb-3">
    <label for="free_text" class="form-label">Skriv sökord</label>
    <input type="text" class="form-control" id="free_text" name="free_text" aria-describedby="free_text_search">
    <div id="free_text_search" class="form-text">Sök på vad du vill</div>
  </div>
  <div class="mb-3">
    <label for="main_category" class="form-label">Huvudkategori</label>
    <select id="search_category_id" name="main_category" class="form-control">
      <option value=None selected="true" disabled>Välj kategori</option>
      <option value="">Ingen</option>
      {%for category in main_categories%}
        <option value={{category[0]}}>{{category[1]}}</option>
      {%endfor%}
    </select>
    <div id="show_sub_categories"></div>
  </div>
  <input type="submit" class="btn btn-primary" value="Sök">
</form>

{%if articles != None%}
  {%for row in articles%}
    <div class="card" style="width: 48rem;">
      {%for image in images%}
          {%if row[0] == image[1]%}
          <img src="/static/article_images/{{image[2]}}" id="temp_pic" class="card-img-top" alt="Artikelbild">
          {%endif%}
      {%endfor%}
      <div class="card-body">
        <h4 class="card-title">Rubrik: {{row[2]}}</h4>
        <p>Stad: {{row[23]}}</p>
        <p>Prisnivå: {{row[26]}}</p>
        <p>Skapad: {{row[6].strftime('%Y-%m-%d')}}</p>
        <p>Kategori: {{row[31]}}</p>
        <form action="/wife_article_id" method="POST">
            {% if current_user_id != None %}
              <input type="hidden" id="wife_article_id" name="wife_article_id" value={{row[0]}}>
            {%endif%}
            <button  class="btn btn-primary" type="submit">Visa intresse</button>
        </form>
      </div>
    </div>
  {%endfor%}
{%else%}
  <p>Inga resultat</p>
{%endif%}

<script type="text/javascript">
$(document).ready(function() {
 $('#search_category_id').change(function(){
    $.post("/get_child_categories", {
     parent_id: $('#search_category_id').val(),
    }, function(response){ 
        $('#show_sub_categories').html(response);
        $('#show_sub_categories').append(response.htmlresponse);
    });
    return false;
  });
}); 
</script>

{% endblock %}